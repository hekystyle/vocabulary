import{r as h,u as _,a as pe,j as c,c as b,C as me,b as x,d as ie,_ as we,e as Se,f as U,g as ye,T as ve,h as Ce,i as $e,k as Ie,S as xe,D as Me,l as O,m as N,n as D,R as be,s as j,o as Pe,p as Ae,q as re,t as Ee,v as ae,w as q,x as $,F as R,y as Oe}from"./index-33b53316.js";import{g as Ne,m as Re,W as ze,L as _e,u as se}from"./compact-item-1babcbb4.js";import{u as He,K,a as Te,Q}from"./queryKeys-a8f389ab.js";import{T as qe}from"./Tags-0c72e561.js";import{R as De}from"./index-e1fb7f5c.js";const je={variant:"primary",active:!1,disabled:!1},B=h.forwardRef(({as:e,bsPrefix:n,variant:t,size:i,active:r,className:s,...a},o)=>{const l=_(n,"btn"),[g,{tagName:f}]=pe({tagName:e,...a});return c(f,{...g,...a,ref:o,className:b(s,l,r&&"active",t&&`${l}-${t}`,i&&`${l}-${i}`,a.href&&a.disabled&&"disabled")})});B.displayName="Button";B.defaultProps=je;const I=B,ce=h.forwardRef(({bsPrefix:e,className:n,variant:t,as:i="img",...r},s)=>{const a=_(e,"card-img");return c(i,{ref:s,className:b(t?`${a}-${t}`:a,n),...r})});ce.displayName="CardImg";const Be=ce,oe=h.forwardRef(({bsPrefix:e,className:n,as:t="div",...i},r)=>{const s=_(e,"card-header"),a=h.useMemo(()=>({cardHeaderBsPrefix:s}),[s]);return c(me.Provider,{value:a,children:c(t,{ref:r,...i,className:b(n,s)})})});oe.displayName="CardHeader";const Le=oe,We=ie("h5"),Fe=ie("h6"),le=x("card-body"),Ue=x("card-title",{Component:We}),Ke=x("card-subtitle",{Component:Fe}),Qe=x("card-link",{Component:"a"}),Xe=x("card-text",{Component:"p"}),Ge=x("card-footer"),Ye=x("card-img-overlay"),Ve={body:!1},L=h.forwardRef(({bsPrefix:e,className:n,bg:t,text:i,border:r,body:s,children:a,as:o="div",...l},g)=>{const f=_(e,"card");return c(o,{ref:g,...l,className:b(n,f,t&&`bg-${t}`,i&&`text-${i}`,r&&`border-${r}`),children:s?c(le,{children:a}):a})});L.displayName="Card";L.defaultProps=Ve;const M=Object.assign(L,{Img:Be,Title:Ue,Subtitle:Ke,Body:le,Link:Qe,Text:Xe,Header:Le,Footer:Ge,ImgOverlay:Ye});var Je=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],de=h.forwardRef(function(e,n){var t,i=e.prefixCls,r=i===void 0?"rc-switch":i,s=e.className,a=e.checked,o=e.defaultChecked,l=e.disabled,g=e.loadingIcon,f=e.checkedChildren,d=e.unCheckedChildren,u=e.onClick,v=e.onChange,p=e.onKeyDown,P=we(e,Je),A=He(!1,{value:a,defaultValue:o}),C=Se(A,2),y=C[0],m=C[1];function w(S,H){var E=y;return l||(E=S,m(E),v==null||v(E,H)),E}function he(S){S.which===K.LEFT?w(!1,S):S.which===K.RIGHT&&w(!0,S),p==null||p(S)}function ge(S){var H=w(!y,S);u==null||u(H,S)}var fe=b(r,s,(t={},U(t,"".concat(r,"-checked"),y),U(t,"".concat(r,"-disabled"),l),t));return h.createElement("button",ye({},P,{type:"button",role:"switch","aria-checked":y,disabled:l,className:fe,ref:n,onKeyDown:he,onClick:ge}),g,h.createElement("span",{className:"".concat(r,"-inner")},h.createElement("span",{className:"".concat(r,"-inner-checked")},f),h.createElement("span",{className:"".concat(r,"-inner-unchecked")},d)))});de.displayName="Switch";const Ze=e=>{const{componentCls:n}=e,t=`${n}-inner`;return{[n]:{[`&${n}-small`]:{minWidth:e.switchMinWidthSM,height:e.switchHeightSM,lineHeight:`${e.switchHeightSM}px`,[`${n}-inner`]:{paddingInlineStart:e.switchInnerMarginMaxSM,paddingInlineEnd:e.switchInnerMarginMinSM,[`${t}-checked`]:{marginInlineStart:`calc(-100% + ${e.switchPinSizeSM+e.switchPadding*2}px - ${e.switchInnerMarginMaxSM*2}px)`,marginInlineEnd:`calc(100% - ${e.switchPinSizeSM+e.switchPadding*2}px + ${e.switchInnerMarginMaxSM*2}px)`},[`${t}-unchecked`]:{marginTop:-e.switchHeightSM,marginInlineStart:0,marginInlineEnd:0}},[`${n}-handle`]:{width:e.switchPinSizeSM,height:e.switchPinSizeSM},[`${n}-loading-icon`]:{top:(e.switchPinSizeSM-e.switchLoadingIconSize)/2,fontSize:e.switchLoadingIconSize},[`&${n}-checked`]:{[`${n}-inner`]:{paddingInlineStart:e.switchInnerMarginMinSM,paddingInlineEnd:e.switchInnerMarginMaxSM,[`${t}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${t}-unchecked`]:{marginInlineStart:`calc(100% - ${e.switchPinSizeSM+e.switchPadding*2}px + ${e.switchInnerMarginMaxSM*2}px)`,marginInlineEnd:`calc(-100% + ${e.switchPinSizeSM+e.switchPadding*2}px - ${e.switchInnerMarginMaxSM*2}px)`}},[`${n}-handle`]:{insetInlineStart:`calc(100% - ${e.switchPinSizeSM+e.switchPadding}px)`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${t}`]:{[`${t}-unchecked`]:{marginInlineStart:e.marginXXS/2,marginInlineEnd:-e.marginXXS/2}},[`&${n}-checked ${t}`]:{[`${t}-checked`]:{marginInlineStart:-e.marginXXS/2,marginInlineEnd:e.marginXXS/2}}}}}}},ke=e=>{const{componentCls:n}=e;return{[n]:{[`${n}-loading-icon${e.iconCls}`]:{position:"relative",top:(e.switchPinSize-e.fontSize)/2,color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${n}-checked ${n}-loading-icon`]:{color:e.switchColor}}}},en=e=>{const{componentCls:n}=e,t=`${n}-handle`;return{[n]:{[t]:{position:"absolute",top:e.switchPadding,insetInlineStart:e.switchPadding,width:e.switchPinSize,height:e.switchPinSize,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:e.colorWhite,borderRadius:e.switchPinSize/2,boxShadow:e.switchHandleShadow,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${n}-checked ${t}`]:{insetInlineStart:`calc(100% - ${e.switchPinSize+e.switchPadding}px)`},[`&:not(${n}-disabled):active`]:{[`${t}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${n}-checked ${t}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}}}},nn=e=>{const{componentCls:n}=e,t=`${n}-inner`;return{[n]:{[t]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:e.switchInnerMarginMax,paddingInlineEnd:e.switchInnerMarginMin,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${t}-checked, ${t}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none"},[`${t}-checked`]:{marginInlineStart:`calc(-100% + ${e.switchPinSize+e.switchPadding*2}px - ${e.switchInnerMarginMax*2}px)`,marginInlineEnd:`calc(100% - ${e.switchPinSize+e.switchPadding*2}px + ${e.switchInnerMarginMax*2}px)`},[`${t}-unchecked`]:{marginTop:-e.switchHeight,marginInlineStart:0,marginInlineEnd:0}},[`&${n}-checked ${t}`]:{paddingInlineStart:e.switchInnerMarginMin,paddingInlineEnd:e.switchInnerMarginMax,[`${t}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${t}-unchecked`]:{marginInlineStart:`calc(100% - ${e.switchPinSize+e.switchPadding*2}px + ${e.switchInnerMarginMax*2}px)`,marginInlineEnd:`calc(-100% + ${e.switchPinSize+e.switchPadding*2}px - ${e.switchInnerMarginMax*2}px)`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${t}`]:{[`${t}-unchecked`]:{marginInlineStart:e.switchPadding*2,marginInlineEnd:-e.switchPadding*2}},[`&${n}-checked ${t}`]:{[`${t}-checked`]:{marginInlineStart:-e.switchPadding*2,marginInlineEnd:e.switchPadding*2}}}}}},tn=e=>{const{componentCls:n}=e;return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},Ce(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:e.switchMinWidth,height:e.switchHeight,lineHeight:`${e.switchHeight}px`,verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${n}-disabled)`]:{background:e.colorTextTertiary}}),$e(e)),{[`&${n}-checked`]:{background:e.switchColor,[`&:hover:not(${n}-disabled)`]:{background:e.colorPrimaryHover}},[`&${n}-loading, &${n}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${n}-rtl`]:{direction:"rtl"}})}},rn=Ne("Switch",e=>{const n=e.fontSize*e.lineHeight,t=e.controlHeight/2,i=2,r=n-i*2,s=t-i*2,a=Re(e,{switchMinWidth:r*2+i*4,switchHeight:n,switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchInnerMarginMin:r/2,switchInnerMarginMax:r+i+i*2,switchPadding:i,switchPinSize:r,switchBg:e.colorBgContainer,switchMinWidthSM:s*2+i*2,switchHeightSM:t,switchInnerMarginMinSM:s/2,switchInnerMarginMaxSM:s+i+i*2,switchPinSizeSM:s,switchHandleShadow:`0 2px 4px 0 ${new ve("#00230b").setAlpha(.2).toRgbString()}`,switchLoadingIconSize:e.fontSizeIcon*.75,switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[tn(a),nn(a),en(a),ke(a),Ze(a)]});var an=globalThis&&globalThis.__rest||function(e,n){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(t[i[r]]=e[i[r]]);return t};const ue=h.forwardRef((e,n)=>{var{prefixCls:t,size:i,disabled:r,loading:s,className:a,rootClassName:o}=e,l=an(e,["prefixCls","size","disabled","loading","className","rootClassName"]);const{getPrefixCls:g,direction:f}=h.useContext(Ie),d=h.useContext(xe),u=h.useContext(Me),v=(r??u)||s,p=g("switch",t),P=h.createElement("div",{className:`${p}-handle`},s&&h.createElement(_e,{className:`${p}-loading-icon`})),[A,C]=rn(p),y=b({[`${p}-small`]:(i||d)==="small",[`${p}-loading`]:s,[`${p}-rtl`]:f==="rtl"},a,o,C);return A(h.createElement(ze,null,h.createElement(de,Object.assign({},l,{prefixCls:p,className:y,disabled:v,ref:n,loadingIcon:P}))))});ue.__ANT_SWITCH=!0;const X=ue;function sn(e){return Object.prototype.toString.call(e)==="[object String]"}var G=Object.prototype.toString,cn=function(){return G.call(arguments)==="[object Arguments]"?function(n){return G.call(n)==="[object Arguments]"}:function(n){return O("callee",n)}}();const on=cn;var ln=!{toString:null}.propertyIsEnumerable("toString"),Y=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],V=function(){return arguments.propertyIsEnumerable("length")}(),dn=function(n,t){for(var i=0;i<n.length;){if(n[i]===t)return!0;i+=1}return!1},un=typeof Object.keys=="function"&&!V?N(function(n){return Object(n)!==n?[]:Object.keys(n)}):N(function(n){if(Object(n)!==n)return[];var t,i,r=[],s=V&&on(n);for(t in n)O(t,n)&&(!s||t!=="length")&&(r[r.length]=t);if(ln)for(i=Y.length-1;i>=0;)t=Y[i],O(t,n)&&!dn(r,t)&&(r[r.length]=t),i-=1;return r});const J=un;var hn=D(function(n,t){var i=n<0?t.length+n:n;return sn(t)?t.charAt(i):t[i]});const gn=hn;var fn=N(function(n){return n==null});const Z=fn;var pn=N(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)});const k=pn;function ee(e){for(var n=[],t;!(t=e.next()).done;)n.push(t.value);return n}function ne(e,n,t){for(var i=0,r=t.length;i<r;){if(e(n,t[i]))return!0;i+=1}return!1}function mn(e){var n=String(e).match(/^function (\w*)/);return n==null?"":n[1]}function wn(e,n){return e===n?e!==0||1/e===1/n:e!==e&&n!==n}const T=typeof Object.is=="function"?Object.is:wn;function te(e,n,t,i){var r=ee(e),s=ee(n);function a(o,l){return W(o,l,t.slice(),i.slice())}return!ne(function(o,l){return!ne(a,l,o)},s,r)}function W(e,n,t,i){if(T(e,n))return!0;var r=k(e);if(r!==k(n))return!1;if(typeof e["fantasy-land/equals"]=="function"||typeof n["fantasy-land/equals"]=="function")return typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](n)&&typeof n["fantasy-land/equals"]=="function"&&n["fantasy-land/equals"](e);if(typeof e.equals=="function"||typeof n.equals=="function")return typeof e.equals=="function"&&e.equals(n)&&typeof n.equals=="function"&&n.equals(e);switch(r){case"Arguments":case"Array":case"Object":if(typeof e.constructor=="function"&&mn(e.constructor)==="Promise")return e===n;break;case"Boolean":case"Number":case"String":if(!(typeof e==typeof n&&T(e.valueOf(),n.valueOf())))return!1;break;case"Date":if(!T(e.valueOf(),n.valueOf()))return!1;break;case"Error":return e.name===n.name&&e.message===n.message;case"RegExp":if(!(e.source===n.source&&e.global===n.global&&e.ignoreCase===n.ignoreCase&&e.multiline===n.multiline&&e.sticky===n.sticky&&e.unicode===n.unicode))return!1;break}for(var s=t.length-1;s>=0;){if(t[s]===e)return i[s]===n;s-=1}switch(r){case"Map":return e.size!==n.size?!1:te(e.entries(),n.entries(),t.concat([e]),i.concat([n]));case"Set":return e.size!==n.size?!1:te(e.values(),n.values(),t.concat([e]),i.concat([n]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var a=J(e);if(a.length!==J(n).length)return!1;var o=t.concat([e]),l=i.concat([n]);for(s=a.length-1;s>=0;){var g=a[s];if(!(O(g,n)&&W(n[g],e[g],o,l)))return!1;s-=1}return!0}var Sn=D(function(n,t){return W(n,t,[],[])});const yn=Sn;var vn=gn(-1);const Cn=vn;var $n=D(function(e,n){for(var t=[],i=0,r=n.length;i<r;){for(var s=i+1;s<r&&e(n[s-1],n[s]);)s+=1;t.push(n.slice(i,s)),i=s}return t});const In=$n,xn="returnUrl",Mn=()=>{const e=window.speechSynthesis;return h.useEffect(()=>()=>e.cancel(),[e]),{speak:n=>{e.cancel();const t=new SpeechSynthesisUtterance(n);e.speak(t)}}},bn=e=>async(n,t)=>{const i=await e.terms.get(n);i&&(i.answersCount+=1,t&&(i.correctAnswersCount+=1),await e.terms.put(i))},F=be({key:"practice/session",default:{config:void 0,isActive:!1,queue:[],isRevealed:!1}}),Pn=j(M.Body)`
  overflow: auto;
`,An=j.div`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
`,En=()=>{const e=Pe(),{pathname:n}=Ae(),{speak:t}=Mn(),{db:i,termsRepository:r}=re(),s=Ee(),[{queue:a,isRevealed:o,config:l},g]=ae(F),f=Cn(a),d=(l==null?void 0:l.playAfterReveal)??!1,{data:u,isFetching:v}=Te(Q.terms.id(f),({signal:m})=>Z(f)?void 0:r.getById(f,m),{enabled:!Z(f),onError:m=>console.error(m)}),{mutateAsync:p,isLoading:P}=se(async({id:m,isCorrect:w})=>await bn(i)(m,w),{onSuccess:(m,{id:w})=>s.invalidateQueries(Q.terms.id(w))}),A=()=>{g(m=>({...m,isRevealed:!0})),u&&d&&t(u.word)},C=m=>{(u==null?void 0:u.id)!==void 0&&p({id:u.id,isCorrect:m}).then(()=>g(w=>({...w,queue:w.queue.slice(0,-1),isRevealed:!1}))).catch(console.error)},y=()=>{u!=null&&u.id&&e(`/records/${u.id}`,{state:{[xn]:n}})};return v?c(q,{label:"Loading term ..."}):P?c(q,{label:"Updating term answers ..."}):u?$(R,{children:[c(M,{children:$(M.Body,{className:"text-center",children:[c("div",{children:u.translation}),$("div",{children:["(",c("i",{children:u.partOfSpeech}),")"]})]})}),c(M,{children:c(Pn,{className:"text-center",children:u.definition})}),c(M,{children:c(M.Body,{className:"text-center",children:o?$(An,{children:[u.word,c(I,{onClick:()=>t(u.word),children:"Play it again"})]}):"?"})}),o?$(R,{children:[c(I,{variant:"success",onClick:()=>C(!0),children:"I was correct"}),c(I,{variant:"danger",onClick:()=>C(!1),children:"I was incorrect"})]}):c(I,{onClick:A,children:"Reveal answer"}),c(I,{onClick:y,children:"Edit current term"})]}):c("p",{children:"You've finished all the terms!"})},On=e=>e.definition!=="",Nn=e=>e.translation!=="";function Rn(e){const n=[...e];let t=n.length;for(;t;){const i=Math.floor(Math.random()*t);t-=1;const r=n[t];n[t]=n[i],n[i]=r}return n}function zn({answersCount:e,correctAnswersCount:n}){return e+n}function _n({answersCount:e,correctAnswersCount:n}){return e===0?0:Math.floor(100/e*n)}var z=(e=>(e.Relative="relative",e.Absolute="absolute",e))(z||{});const Hn=e=>typeof e=="string"&&Object.values(z).some(yn(e)),Tn={relative:_n,absolute:zn},qn=e=>async({ignoreScoreOfNewTerms:n,scoreAlgorithm:t,tags:i})=>{const r=[],s=new Set(i);return await e.terms.filter(a=>(Nn(a)||On(a))&&(s.size===0||a.tags.some(o=>s.has(o)))).each(a=>{r.push({id:a.id,score:n&&a.answersCount<10?0:Tn[t](a)})}),r.sort((a,o)=>o.score-a.score),In((a,o)=>a.score===o.score,r).map(a=>Rn(a)).reduce((a,o)=>[...a,...o.map(l=>l.id)],[])},Dn=()=>{const{db:e}=re(),n=Oe(F),[t,i]=h.useState({scoreAlgorithm:z.Relative,playAfterReveal:!1,ignoreScoreOfNewTerms:!1,tags:[]}),{isLoading:r,mutateAsync:s}=se(qn(e),{onError:d=>console.error(d)}),a=()=>{s(t).then(d=>n({config:t,queue:d,isActive:!0,isRevealed:!1})).catch(console.error)},o=d=>i(u=>({...u,...d}));if(r)return c(q,{label:"Preparing practice session queue ..."});const{scoreAlgorithm:l,playAfterReveal:g,ignoreScoreOfNewTerms:f}=t;return $(R,{children:[c(De.Group,{buttonStyle:"solid",name:"scoreAlgorithm",optionType:"button",options:Object.values(z).map(d=>({label:d,value:d,style:{flexGrow:1,textAlign:"center"}})),style:{display:"flex"},value:l,onChange:({target:{value:d}})=>o({scoreAlgorithm:Hn(d)?d:void 0})}),c(X,{checked:g,checkedChildren:"Play word after reveal",unCheckedChildren:"Play word after reveal",onChange:d=>o({playAfterReveal:d})}),c(X,{checked:f,checkedChildren:"Ignore score for items with less then 11 answers",unCheckedChildren:"Don't ignore score for items with less then 11 answers",onChange:d=>o({ignoreScoreOfNewTerms:d})}),c(qe,{style:{width:"100%"},value:t.tags,onChange:d=>o({tags:d})}),c(I,{onClick:a,children:"Start session"})]})},jn=j.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 1rem;
`,Kn=()=>{const[{isActive:e},n]=ae(F);return c(jn,{children:e?$(R,{children:[c(En,{}),c(I,{onClick:()=>{n(i=>({...i,config:void 0,queue:[],isActive:!1}))},children:"End session"})]}):c(Dn,{})})};export{Kn as default};
